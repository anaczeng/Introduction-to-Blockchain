#### 5.2.1 网络概览

运行比特币代码的机器（节点）以及传递其信息的信道基础设施构成了区块链的网络。比特币网络的最大特点就是去中心化。所谓的去中心化，即网络中的节点都高度自治，节点与节点间不存在附属关系；也即是我们常说的点对点网络（P2P Network）。它与主从模式（master-slave）和服务器客户端模式（server-client）的中心化网络形成了鲜明的对比。

上节已介绍了比特币网络的三类主要节点：全节点，挖矿节点以及SPV节点。不同功能的节点相互协作以完成整个系统的功能，但每个节点都保持着高度的自治。即使某一节点突然中途加入或退出，对整个网络或系统都不构成太大影响。因此，比特币区块链网络的动态变化极为活跃。节点进出网络以及扩散信息的流程类似，下面章节将会详细介绍。

#### 5.2.2 进入

当一个新节点要进入比特币区块链网络时，首先找到它的种子节点。然后，新节点给种子节点发出一个特殊信息，让种子节点将所知的所有网络节点告知自己。新节点可以不断重复该过程。最后，新节点随机从已知道的节点中选出同伴节点。至此，它已经完全加入进网络中了。

表5-3：种子节点和同伴节点。

![](/assets/fig-table-5-3.png)

![](/assets/fig-5-19-1.png)![](/assets/fig-5-19-2.png)

![](/assets/fig-5-19-3.png)

图5-19：新节点进入网络的示意图。

#### 5.2.3 退出

当一个节点退出网络时，只需要停止运行程序即可。当它退出网络后，以它为同伴节点的其他节点将不可能再接听到它的信息；这种情况只要持续3小时，该退出节点将不会出现在其他节点的同伴节点名单中。

![](/assets/fig-5-20.png)

图5-20：节点退出网络的示意图。

#### 5.2.4 扩散

有效交易或区块的扩散执行了泛洪算法（Flooding Algorithm），也可以称为流言算法\(Gossip Protocol\)。它的过程如下：当全节点确认一个交易或区块有效后，它就会将该交易或区块发送给同伴节点；同伴节点验证该交易或区块的有效性后，又将其发送它的同伴节点。这样，有效交易或区块就逐渐被全网的节点收到，而非有效的交易或区块就被丢弃了。

![](/assets/fig-5-21-1.png)

![](/assets/fig-5-21-2.png)

图5-21：节点扩散消息（交易或区块）示意图。该例中的节点都是全节点，所以它们都是在验证消息合法性后再转发消息。若产生交易的为SPV节点，它将直接转发交易给全节点验证合法性再转发。

